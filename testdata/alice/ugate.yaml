# Minimal settings, for a client - has one cluster for bob
# Range: 120xx
name: a

# deprecated - in domain.
namespace: alice
domain: test.m.internal

# Global settings
connecttimeout: 5s

# deprecated - in MDS
#"gsa":         "k8s-default@csm-pp-bug-bash-5.iam.gserviceaccount.com"
#"project_id":   "csm-pp-bug-bash-5"
# Replaced by ID
serviceaccount: default
projectid: dmeshgate
location: us-central1

id:
  namespace: test
  serviceaccount: default
  location: us-central1
  trustDomain: dmeshgate.id.goog
  labels:
    projectid: dmeshgate


########################### Static listeners ############
# Default range is 15000...15099 (100 ports)
#
# A better assignment would be to have ranges of 100 (or 128) ports for each prot
listeners:
  # Local discovery module
  local: {}

  ssh:
    port: 2202

  # TLS - H2 or H1, main Mux.
  h2:
    port: 12108

  quic:
    port: 12108

  ipfs:
    port: 12103
    protocol: ipfs


  # ======== Egress
  # Local traffic, will send to original dst or secure depending on dst.

  # Only if root
  tpudp:
    port: 12102
    protocol: tproxy_udp

  tproxy:
    port: 12106

  socks:
    port: 12104

  httpproxy:
    port: 12105
    protocol: http_proxy

  # ======= HBone / multiplexed ingress

  # Plain text HTTP/2
  h2c:
    port: 12109

  # Should be on same port with H2
  sni:
    port: 12111

  # ======= Admin/debug port

  admin:
    port: 12100

  metrics:
    port: 12120

  mqtt:
    port: 12101
    protocol: mqtt

  # ======== Regular listeners
  udp:
    port: 12109

  echo:
    port: 12113


########################### Static destinations ############

dst:
  b.bob.test.mesh.internal:
    addr: 127.0.0.3
    id: NF2UGZAZTEH2K4WQDJCSJBTKTAUMZDZP4P3664TK2SKZ3NSAOD3Q
    endpoints:
      - address: 127.0.0.1:5201
        hboneaddress: 127.0.0.1:15209
        secure: true
